<html>

<head>
  <script src="https://unpkg.com/@microsoft/mgt/dist/bundle/mgt-loader.js"></script>
  <script>
    const ready = async () => { };
  </script>
</head>

<body onload="ready()">
  <script>
    const displayMail = async () => {
      const token = await Providers.globalProvider.getAccessToken({ scopes: ["User.Read"] });
      alert(token);
    };
  </script>
  <mgt-msal2-provider client-id="5b7415c3-bdf8-48bd-94ad-19ef8debf02a" login-type="redirect/popup"
    scopes="user.read,people.read" redirect-uri="http://localhost:5500/PlainJavascript/plainExample.html">
  </mgt-msal2-provider>

  <div id="main">
    <div class="fcf-body">
      <div id="fcf-form">
        <h3 class="fcf-h3">Contact us</h3>

        <form id="fcf-form-id" class="fcf-form-class" method="post">
          <div class="fcf-form-group">
            <label for="Email" class="fcf-label">Recipient</label>
            <div class="fcf-input-group">
              <mgt-people-picker></mgt-people-picker>
            </div>
          </div>

          <div class="fcf-form-group">
            <label for="Message" class="fcf-label">Subject</label>
            <div class="fcf-input-group">
              <textarea id="Message" name="Message" class="fcf-form-control" rows="6" maxlength="3000"
                required></textarea>
            </div>
          </div>

          <div class="fcf-form-group">
            <label for="Message" class="fcf-label">Message</label>
            <div class="fcf-input-group">
              <textarea id="Message" name="Message" class="fcf-form-control" rows="6" maxlength="3000"
                required></textarea>
            </div>
          </div>

          <div class="fcf-form-group">
            <button type="submit" id="fcf-button" class="fcf-btn fcf-btn-primary fcf-btn-lg fcf-btn-block">Send
              Message</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script>
    const signedIn = async () => {
      if (mgt.Providers.globalProvider.state === mgt.ProviderState.SignedIn) {
        await displayMail();
      }
    };
    mgt.Providers.onProviderUpdated(signedIn);
  </script>
</body>

</html>